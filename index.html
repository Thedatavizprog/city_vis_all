<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Quality Visualization</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.6/build/pure-min.css">
    <style>
        .description {
            font-size: 1.2em;
            color: #555;
        }
        section h2 {
            color: #333;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
        }
        .visualization {
            width: 80%;
            margin-bottom: 50px;
        }
    </style>
</head>

<body>
    <h1>Air Quality Visualization</h1>
    <p class="description">Explore the variations in AQI and specific pollutants across different cities.</p>

    <!-- Map Visualization -->
    <section>
        <h2>Map Visualization</h2>
        <div id="map"></div>
    </section>

    <!-- Description -->
    <section>
        <h2>About the Map Visualisation</h2>
        <p class="description">
            This visualisation illuminates the disparities in Air Quality Index (AQI) values across various cities globally. Circles on the map represent cities, with their size and colour indicating the AQI value; larger, darker circles signify higher AQI values, illustrating poorer air quality. Divergent air quality conditions, from "Good" to "Hazardous," reveal the multifaceted nature of global air quality challenges. Special attention is brought to cities like Bahawalnagar, Pakistan, which experiences alarmingly poor air quality, juxtaposed against cities like Macas, Ecuador, with notably cleaner air. Such visual representation underscores the urgent need for global, targeted, and context-specific interventions to mitigate air pollution and its pervasive impacts.
        </p>
    </section>

    
    <!-- Bar Chart Visualization -->
    <section>
        <h2>CO AQI Bar Chart</h2>
        <div id="bar-chart"></div>
    </section>

      <!-- Description -->
      <section>
        <h2>About the Bar plot Visualisation</h2>
        <p class="description">
            The bar chart depicts Carbon Monoxide (CO) Air Quality Index (AQI) values across various cities in Australia and Malaysia. The overwhelming majority of cities have 'Good' air quality with low CO levels, while one city exhibits 'Moderate' AQI, indicating higher but still acceptable CO levels.        </p>
    </section>

    <!-- Pie Chart Visualization -->
    <section>
        <h2>AQI Category Distribution</h2>
        <div id="pie-chart"></div>
    </section>

    <section>
        <h2>About the Pie Chart Visualisation</h2>
        <p class="description">
            The pie chart presents the distribution of Air Quality Index (AQI) categories. Each slice represents a category's prevalence within the dataset. 'Good' AQI indicates low pollution levels, while 'Moderate' suggests acceptable air quality, albeit with some pollutants that may be a concern for a very small number of individuals who are unusually sensitive to air pollution. 'Unhealthy for Sensitive Groups' signifies that members of sensitive groups may experience health effects, but the general public is unlikely to be affected. 'Unhealthy' and 'Very Unhealthy' categories denote increased health risks for all. This visualization aids in understanding the overall air quality and potential health implications.        </p>
    </section>




    <!-- Histogram Visualization -->
     <section>
        <h2>Histogram Visualisation</h2>
        <div id="hist" class="visualisation"></div>
        <label for="aqiSlider">AQI Value:</label>
        <input type="range" id="aqiSlider" name="aqiSlider" min="0" max="500" step="10" value="0">
        <span id="sliderValue">0</span>
    </section>

    <!-- Histogram Description -->
<section>
    <h2>About the Histogram Visualisation</h2>
    <p class="description">
        The histogram visualisation provides a compelling overview of Air Quality Index (AQI) values distributed across various cities around the world. By aggregating the number of cities falling within certain AQI value ranges and representing them as bars, the histogram enables a quick visual comparison of global urban air quality. Each bar’s height indicates the number of cities that fall within a particular AQI bin, allowing for a stark visualisation of how many cities are grappling with different levels of air quality issues. Through the utilisation of an interactive slider, users can dynamically adjust the AQI threshold, offering a versatile examination and making evident the quantity of cities that exist below a certain AQI, thus granting a nuanced understanding of global air quality in a segmented fashion. This clear and interactive visualisation method supports both experts and regular citizens in their exploration and analysis of global air quality data.
    </p>
</section>

    <!-- Stacked Bar Chart Visualization -->
    <section>
        <h2>Pollutant AQI Categories per City</h2>
        <div id="stacked-bar-chart"></div>
    </section>

    <!-- Storytelling Section -->
    <section>
        <h2>Exploring Air Quality Across Cities</h2>
        <p class="description">
            Embark on a journey through the vast landscapes of <strong>Australia</strong> and the vibrant cities of <strong>Malaysia</strong>,
            exploring the invisible yet crucial aspect that sustains life – <strong>air quality</strong>.<br><br>
            
            In the land down under, most cities bask under the ‘Good’ air quality, with the breezy coasts and expansive outbacks of
            <strong>83 cities</strong>, including <strong>Geraldton</strong>, providing a breath of fresh air. However, amidst this, some cities like
            <strong>Palmerston</strong> lurk into the shadows of particulate matter, presenting an AQI that reaches a staggering <strong>264</strong>,
            the highest among all observed cities.<br><br>
            
            Transitioning to the tropical and bustling milieu of Malaysia, the story takes a different turn. Cities such as <strong>Miri</strong> and
            <strong>Pasir Gudang</strong> grapple with pollutants like <strong>CO</strong>, <strong>Ozone</strong>, and <strong>NO2</strong>,
            reaching AQI values of <strong>67</strong>, <strong>209</strong>, and <strong>21</strong> respectively, posing potential threats
            to health and environment.<br><br>
            
            The picturesque settings of <strong>Wangaratta, Australia</strong>, provide not only scenic views but also some of the cleanest airs,
            with the lowest overall AQI. Yet, the narrative isn’t solely about the extremes but also about the collective measures, challenges,
            and steps that every city, whether in Australia or Malaysia, undertakes to tread on the path of sustainable and clean air.<br><br>
            
            As you delve into the visualizations, explore the varied spectrum of AQI values and categories, and ponder upon the intricate balance
            between urbanization and maintaining air quality. Notice the subtle and sometimes stark contrasts between different cities and pollutants,
            and immerse yourself in the narrative that intertwines data with the very air we breathe.<br><br>
            
            This journey through air quality across cities is not just data; it’s a reflection, an exploration, and perhaps, a call to conscious,
            sustainable living, where every breath counts, and every city strives towards clearer skies and cleaner air.
        </p>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script>
        // Embed the map visualization
        vegaEmbed('#map', 'map.json').catch(console.error);

        // Initialize histogram without filtering
        renderHistogram(500);

        // Update the histogram visualization when the slider value changes
        document.getElementById('aqiSlider').addEventListener('input', function (e) {
            let aqiValue = e.target.value;
            document.getElementById('sliderValue').textContent = aqiValue;
            renderHistogram(aqiValue);
        });

        // Function to render the histogram with a filter applied
        function renderHistogram(aqiValue) {
            var spec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "description": "A histogram of AQI values",
                "data": {"url": "data.csv"},
                "title": "Distribution of AQI Values Across Various Cities",
                "mark": "bar",
                "transform": [{"filter": `datum["AQI Value"] <= ${aqiValue}`}],
                "encoding": {
                    "x": {
                        "bin": true,
                        "field": "AQI Value",
                        "type": "quantitative",
                        "axis": {"title": "AQI Value"}
                    },
                    "y": {
                        "aggregate": "count",
                        "type": "quantitative",
                        "axis": {"title": "Count of Cities"}
                    },
                    "color": {
                        "value": "steelblue"
                    },
                    "tooltip": [
                        {"field": "AQI Value", "type": "quantitative", "title": "AQI Value Bin"},
                        {"field": "Country", "type": "nominal", "title": "Country"},
                        {"field": "City", "type": "nominal", "title": "City"},
                        {"field": "AQI Category", "type": "nominal", "title": "AQI Category"},
                        {"aggregate": "count", "type": "quantitative", "title": "City Count in Bin"}
                    ]
                },
                "height": 350,
                "width": 550,
                "config": {
                    "title": {"fontSize": 16, "fontWeight": "bold"},
                    "axis": {"labelFontSize": 12, "titleFontSize": 14},
                    "legend": {"labelFontSize": 12, "titleFontSize": 14},
                    "tooltip": {"fontSize": 12}
                }
            };
            vegaEmbed('#hist', spec).catch(console.error);
        }
    </script>
    <script>
        vegaEmbed('#map', 'map.json').catch(console.error);
        vegaEmbed('#bar-chart', 'bar.json').catch(console.error);
        vegaEmbed('#pie-chart', 'pie.json').catch(console.error);
        vegaEmbed('#histogram', 'hist.json').catch(console.error);
        vegaEmbed('#stacked-bar-chart', 'stacked.json').catch(console.error);
    </script>
</body>

</html>
